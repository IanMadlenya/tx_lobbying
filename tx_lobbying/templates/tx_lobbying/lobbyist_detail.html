{% extends "tx_lobbying/base.html" %}
{% load humanize %}

{% block head_title %}{{ object }}{% endblock %}

{% block main %}
  <h1>{{ object }}</h1>
  <a href="{{ object.address.get_absolute_url }}">
    {{ object.address }}
  </a>

  <section>
    <h2>Name History</h2>
    <ul>
      {% for name, cover in object.get_name_history %}
        <li>{{ name }} ({{ cover.report_date }})</li>
      {% empty %}
        <li><em>None</em></li>
      {% endfor %}
    </ul>
  </section>
  <section>
    <h2>Address History</h2>
    <ul>
      {% for address, report in object.get_address_history %}
        <li>
          <a href="{{ address.get_absolute_url }}">
            {{ address }} ({{ report.year }})
          </a>
        </li>
      {% empty %}
        <li><em>None</em></li>
      {% endfor %}
    </ul>
  </section>
  <section>
    <h2>Clients</h2>
    <ul>
      {% for yeardata in object.years.all %}
        <li>
          {{ yeardata.year }}
          <ul>
            {% for client in yeardata.compensation_set.all %}
              <li>
                <a href="{{ client.interest.get_absolute_url }}">
                  {{ client.interest.name|default:"TODO" }}
                </a>
                {% if client.interest.canonical %}
                  <em>(data cleaned to: <a href="{{ client.interest.canonical.get_absolute_url }}">
                    {{ client.interest.canonical.name|default:"TODO" }}
                  </a>)</em>
                {% endif %}
                ${{ client.amount_low|intcomma }} &mdash; ${{ client.amount_high|intcomma }}
              </li>
            {% endfor %}
          </ul>
        </li>
      {% empty %}
        <li><em>None</em></li>
      {% endfor %}
    </ul>
  </section>
  <section>
    <h2>Stats</h2>
    <table class="table">
      <thead>
        <tr>
          <th>Year</th>
          <th>Total</th>
          <th class="extrainfo">Transportation</th>
          <th class="extrainfo">Food</th>
          <th class="extrainfo">Entertainment</th>
          <th class="extrainfo">Gifts</th>
          <th class="extrainfo">Awards</th>
          <th class="extrainfo">Events</th>
          <th class="extrainfo">Media</th>
          <th class="extrainfo">Senators</th>
          <th class="extrainfo">Representatives</th>
          <th class="extrainfo">Other</th>
          <th class="extrainfo">Legislative</th>
          <th class="extrainfo">Executive</th>
          <th class="extrainfo">Family</th>
          <th class="extrainfo">Events</th>
          <th class="extrainfo">Guests</th>
          <th class="extrainfo">Details</th>
        </tr>
      </thead>
      <tbody>
        {% for stat in object.stats.all %}
          <tr>
            <td>
              {{ stat.year }}
            </td>
            <td class="currency">
              {% if stat.spent_guess %}
                ${{ stat.spent_guess|intcomma }}
              {% endif %}
            </td>
            <td class="extrainfo">{% if stat.transportation %}${{ stat.transportation|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.food %}${{ stat.food|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.entertainment %}${{ stat.entertainment|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.gifts %}${{ stat.gifts|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.awards %}${{ stat.awards|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.events %}${{ stat.events|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.media %}${{ stat.media|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.ben_senators %}${{ stat.ben_senators|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.ben_representatives %}${{ stat.ben_representatives|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.ben_other %}${{ stat.ben_other|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.ben_legislative %}${{ stat.ben_legislative|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.ben_executive %}${{ stat.ben_executive|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.ben_family %}${{ stat.ben_family|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.ben_events %}${{ stat.ben_events|intcomma }}{% endif %}</td>
            <td class="extrainfo">{% if stat.ben_guests %}${{ stat.ben_guests|intcomma }}{% endif %}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  <section class="extrainfo">
    <h2>Cover Sheets</h2>
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Transportation</th>
          <th>Food</th>
          <th>Entertainment</th>
          <th>Gifts</th>
          <th>Awards</th>
          <th>Events</th>
          <th>Media</th>
          <th>Senators</th>
          <th>Representatives</th>
          <th>Other</th>
          <th>Legislative</th>
          <th>Executive</th>
          <th>Family</th>
          <th>Events</th>
          <th>Guests</th>
          <th>Details</th>
        </tr>
      </thead>
      <tbody>
        {% for cover in object.coversheets.all %}
          <tr>
            <td>{{ cover.report_date|date:"Y-m-d" }}</td>
            <td>{% if cover.transportation %}${{ cover.transportation|intcomma }}{% endif %}</td>
            <td>{% if cover.food %}${{ cover.food|intcomma }}{% endif %}</td>
            <td>{% if cover.entertainment %}${{ cover.entertainment|intcomma }}{% endif %}</td>
            <td>{% if cover.gifts %}${{ cover.gifts|intcomma }}{% endif %}</td>
            <td>{% if cover.awards %}${{ cover.awards|intcomma }}{% endif %}</td>
            <td>{% if cover.events %}${{ cover.events|intcomma }}{% endif %}</td>
            <td>{% if cover.media %}${{ cover.media|intcomma }}{% endif %}</td>
            <td>{% if cover.ben_senators %}${{ cover.ben_senators|intcomma }}{% endif %}</td>
            <td>{% if cover.ben_representatives %}${{ cover.ben_representatives|intcomma }}{% endif %}</td>
            <td>{% if cover.ben_other %}${{ cover.ben_other|intcomma }}{% endif %}</td>
            <td>{% if cover.ben_legislative %}${{ cover.ben_legislative|intcomma }}{% endif %}</td>
            <td>{% if cover.ben_executive %}${{ cover.ben_executive|intcomma }}{% endif %}</td>
            <td>{% if cover.ben_family %}${{ cover.ben_family|intcomma }}{% endif %}</td>
            <td>{% if cover.ben_events %}${{ cover.ben_events|intcomma }}{% endif %}</td>
            <td>{% if cover.ben_guests %}${{ cover.ben_guests|intcomma }}{% endif %}</td>
            <td>
              {% if cover.details.exists %}
                <ul>
                  {% for detail in cover.details.all %}
                    <li>{{ detail.type }} - {{ detail.amount_guess }}</li>
                  {% endfor %}
                </ul>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

{% endblock %}
